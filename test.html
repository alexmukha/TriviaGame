<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Trivia Game</title>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.0.0/css/bootstrap.min.css" />
    <link rel="stylesheet" href="assets/css/style.css">


</head>
<body>
    <div class="container text-center">
        <div class="jumbotron">
            <h1>TRIVIA GAME</h1>
            <p>This is a very random trivia questions game. Please get your mind ready for this game, because nobody knows what questions are going to be asked and on what topic. All of the questions are going to be straight from the internet and in the random format. </p>
            <!-- <div id="timer"></div> -->
           <h3><span id="timer" class="btn-primary normal">Are you ready??<br>Press ==> Start <== PRESSS</span></h3>
          <button id="btnnext" class="btn">next</button>&nbsp;&nbsp;<button id="btnstop" class="btn">stop</button>
        </div>
        <div id="questions">

        </div>
    
    
    
    </div>
<script> $(document).ready(function() {
        var timeLeft = 5;
        //var correct = 0;
        //var incorrect = 0;
        //var questionNum = 0;
        var amount = 15;
        var questions = [];
        var answers = [];
        var timerId;
        var gameInProgress = false;


        var queryURL = "https://opentdb.com/api.php?amount="+amount+"&difficulty=easy&type=multiple";
        var $div = $("<div>");

    $("#timer").on("click", function () {
        start();
        $("#timer").removeClass("btn-primary");
    })

    $("#btnnext").on("click", function () {
      timeLeft = 0;
      $("#timer").empty();
    })

    $("#btnstop").on("click", function () {
        timeLeft = 0;
      $("#timer").empty();
     
    })

    function checkResults() {
        if (timeLeft == 0) {
    $("#timer").removeClass("warning").addClass("normal");
    $("#timer").html("<b>Time\'s Up</b><BR>&nbsp;");
    } else {
        timeLeft = 0;
        console.log(timeLeft);
    }
    }

    function start(){
        gameInProgress = true;
        console.log("start funct");
      var timerId = setInterval(countdown, 1000);
      console.log(gameInProgress);
      
    }

    function countdown() {
      if (timeLeft <= -0) {
          clearTimeout(timerId);
          checkResults();
      } else {
        if (timeLeft < 3) {
          $("#timer").removeClass("normal").addClass("warning");
        }
          $("#timer").html("You have "+timeLeft+" seconds<BR>to answer the question!");
          timeLeft--;
      }
    }

    $.ajax({
      url: queryURL,
      method: "GET"
    }).then(function(response) {
    function shuffle(array) {
            var temp;
            var i = array.length
            while (i) {
                var m = Math.floor(Math.random() * i--);
                temp = array[i];
                array[i] = array[m];
                array[m] = temp; };
            return array; };

for (var i = 0; i < response.results.length; i++) {
delete response.results[0].difficulty;
delete response.results[0].type;
questions.push(response.results[i]);
answers.push(questions[i].incorrect_answers);
answers[i].push(questions[i].correct_answer);
shuffle(answers[i]);
}

      var category = response.results[0].category;
      var $category = $('<div><b>Category:</b> '+category+ '</div>');
      $div.append($category);

      var question = response.results[0].question;
      var $question = $('<div><b>Question:</b> '+question+ '</div>');
      $div.append($question);

      var answer0 = answers[0][0];
      var $answer0 = $('<div class="check" value="'+answers[0]+'"><b>Answer0:</b> '+answer0+' === '+answers[0][0]+'</div>');
      $div.append($answer0);


      var answer1 = answers[0][1];
      var $answer1 = $('<div class="check" value="'+answers[1]+'"><b>Answer1:</b> '+answer1+' === '+answers[0][1]+'</div>');
      $div.append($answer1);

      var answer2 = answers[0][2];
      var $answer2 = $('<div class="check" value="'+answers[2]+'"><b>Answer2:</b> '+answer2+' === '+answers[0][2]+'</div>');
      $div.append($answer2);

      var answer3 = answers[0][3];
      var $answer3 = $('<div class="check" value="'+answers[3]+'"><b>Answer3:</b> '+answer3+' === '+answers[0][3]+'</div>');
      $div.append($answer3);

      

      $(".check").on("click", function(event) {
        console.log($(".check").attr("value"));
       return event;
    });

    console.log(questions);


    })
$("#questions").append($div);
  


console.log(gameInProgress);

}); </script>

</body>
</html>